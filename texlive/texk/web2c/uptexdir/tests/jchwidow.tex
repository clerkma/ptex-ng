%#!euptex
\font\cmr=cmr10\cmr
\ifx\kanjiskip\undefined\else
  \ifnum\jis"2121="3000
    \jfont\jpy=umin10 at 10pt\jpy
  \else
    \jfont\jpy=min10 at 10pt\jpy
  \fi
\fi

\def\TEST#1{{\setbox0=\vbox{\noindent
  ã‚ã‚ã‚ã‚ã‚ã‚%
  \ifx\scantokens\undefined\else\scantokens\fi
  {#1}}\showboxbreadth10000\showboxdepth10000\tracingonline1\showbox0}}

\message{TEST}

\chardef\CR=`ã™
\TEST{ã™{\kcatcode`ã™=18 ã™}ã€Œã€‚}
\TEST{\CRã€‚}
\ifx\Ucharcat\undefined\else
\TEST{\Ucharcat`ã™ 16ã€‚}
\TEST{\Ucharcat`ã™ 17ã€‚}
\TEST{\Ucharcat`ã™ 18ã€‚}
\TEST{\Ucharcat`ã™ 19ã€‚}
\fi

\TEST{ã™ã€‚}
\TEST{ã™\char\kuten"0103}
\ifx\kchar\undefined\else
\TEST{ã™\kchar\kuten"0103}
\fi

\TEST{\char\kuten"0419ã€‚}
\TEST{\char\kuten"0419\char\kuten"0103}
\ifx\kchar\undefined\else
\TEST{\char\kuten"0419\kchar\kuten"0103}

\kchardef\KR=`ã™
\TEST{\KRã€‚}
\TEST{\kchar\kuten"0419ã€‚}
\TEST{\kchar\kuten"0419\char\kuten"0103}
\TEST{\kchar\kuten"0419\kchar\kuten"0103}
\fi

{\kcatcode`Î±=15
\ifx\kchar\undefined\else
  \message{KCHAR"3B1, kcatcode=15}
  \def\S{\kchar"03B1}
  \TEST{ã„\kchar"03B1ã€‚}
  \TEST{\kchar"03B1ã€‚}
  \TEST{\relax\kchar"03B1ã€‚}
  \TEST{\vrule\kchar"03B1ã€‚}
  \TEST{b\kchar"03B1ã€‚}
  \TEST{ã„\Sã€‚}
\fi

  \message{CHAR"3B1, kcatcode=15}
  \def\S{\char"03B1}
  \TEST{ã„\char"03B1ã€‚}
  \TEST{\char"03B1ã€‚}
  \TEST{\relax\char"03B1ã€‚}
  \TEST{\vrule\char"03B1ã€‚}
  \TEST{b\char"03B1ã€‚}
  \TEST{ã„\Sã€‚}

\ifx\kchardef\undefined\else
  \message{KCHARDEF"3B1, kcatcode=15}
  \kchardef\KA="3B1
  \TEST{ã„\KA ã€‚}
  \TEST{\KA ã€‚}
  \TEST{\relax\KA ã€‚}
  \TEST{\vrule\KA ã€‚}
  \TEST{b\KA ã€‚}
  \TEST{ã„\Sã€‚}
\fi

  \message{CHARDEF"3B1, kcatcode=15}
  \chardef\CA="3B1
  \TEST{ã„\CA ã€‚}
  \TEST{\CA ã€‚}
  \TEST{\relax\CA ã€‚}
  \TEST{\vrule\CA ã€‚}
  \TEST{b\CA ã€‚}
}

%% prebreakpenalty, postbreakpenalty
\ifx\kchar\undefined\else

\showboxbreadth10000
\showboxdepth10000

% default
\setbox0\hbox{ã•ã‡·ã‚šã‚µã—ã‹ã‚šã‚·ã™ã‚ã‚™ã‚¹ã›ğ›‚¦ã‚™ã‚»ãğ›‚±ã‚šã‚½ãŸã£ã‚¿}
\showbox0

% prebreakpenalty
\prebreakpenalty`ã‡·=41
\prebreakpenalty`ã‹=42
\prebreakpenalty`ã‚=43
\prebreakpenalty`ğ›‚¦=44
\prebreakpenalty`ğ›‚±=45
\prebreakpenalty`ã£=46
\setbox1\hbox{ãŸã‡·ã‚šã‚¿ã¡ã‹ã‚šãƒã¤ã‚ã‚™ãƒ„ã¦ğ›‚¦ã‚™ãƒ†ã¨ğ›‚±ã‚šãƒˆãªã£ãƒŠ}
\showbox1

% postbreakpenalty
\postbreakpenalty`ã‡·=51
\postbreakpenalty`ã‹=52
\postbreakpenalty`ã‚=53
\postbreakpenalty`ğ›‚¦=54
\postbreakpenalty`ğ›‚±=55
\postbreakpenalty`ã£=56
\setbox2\hbox{ãªã‡·ã‚šãƒŠã«ã‹ã‚šãƒ‹ã¬ã‚ã‚™ãƒŒã­ğ›‚¦ã‚™ãƒã®ğ›‚±ã‚šãƒã¯ã£ãƒ}
\showbox2

% reset
\prebreakpenalty`ã‡·=0
\postbreakpenalty`ã‹=0
\prebreakpenalty`ã‚=0
\postbreakpenalty`ğ›‚¦=0
\prebreakpenalty`ğ›‚±=0
\postbreakpenalty`ã£=0
\setbox3\hbox{ã¯ã‡·ã‚šãƒã²ã‹ã‚šãƒ’ãµã‚ã‚™ãƒ•ã¸ğ›‚¦ã‚™ãƒ˜ã»ğ›‚±ã‚šãƒ›ã¾ã£ãƒ}
\showbox3

\fi

\bye

